
OPENSSL-0.9.8zd(Client,Safe) LOG:

openssl-0.9.8zd$ ./apps/openssl s_client -cipher NULL-SHA -msg -tls1
CONNECTED(00000003)
>>> TLS 1.0 Handshake [length 0035], ClientHello
    01 00 00 31 03 01 55 12 a0 ed 12 25 01 60 53 e9
    ee bd ab 09 f7 21 77 d5 72 52 b2 b1 de 02 91 bc
    7e a4 81 19 16 90 00 00 04 00 02 00 ff 01 00 00
    04 00 23 00 00
<<< TLS 1.0 Handshake [length 0035], ServerHello
    02 00 00 31 03 01 55 12 a0 ed 50 f8 4f 8e d9 ba
    17 3f 29 c5 a6 c5 7b 31 c9 7e 2d 70 fd 78 68 0a
    7b 29 d3 79 50 76 00 00 02 00 00 09 ff 01 00 01
    00 00 23 00 00
<<< TLS 1.0 Handshake [length 0237], Certificate
    0b 00 02 33 00 02 30 00 02 2d 30 82 02 29 30 82
    01 d3 02 09 00 df 98 6f 1f 49 dc ed 59 30 0d 06
    09 2a 86 48 86 f7 0d 01 01 04 05 00 30 7a 31 0b
    30 09 06 03 55 04 06 13 02 49 4e 31 12 30 10 06
    03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b 61 31
    12 30 10 06 03 55 04 07 0c 09 62 61 6e 67 61 6c
    6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02 4e 4d
    31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31 0f 30
    0d 06 03 55 04 03 0c 06 63 68 65 74 61 6e 31 18
    30 16 06 09 2a 86 48 86 f7 0d 01 09 01 16 09 6e
    6d 40 6e 6d 2e 63 6f 6d 30 1e 17 0d 31 35 30 33
    31 36 31 30 31 34 30 32 5a 17 0d 31 37 30 33 31
    35 31 30 31 34 30 32 5a 30 79 31 0b 30 09 06 03
    55 04 06 13 02 49 4e 31 12 30 10 06 03 55 04 08
    0c 09 6b 61 72 6e 61 74 61 6b 61 31 12 30 10 06
    03 55 04 07 0c 09 62 61 6e 67 61 6c 6f 72 65 31
    0b 30 09 06 03 55 04 0a 0c 02 4e 4d 31 0b 30 09
    06 03 55 04 0b 0c 02 4e 4d 31 0e 30 0c 06 03 55
    04 03 0c 05 6a 61 63 6f 62 31 18 30 16 06 09 2a
    86 48 86 f7 0d 01 09 01 16 09 6e 6d 40 6e 6d 2e
    63 6f 6d 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d
    01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00
    b2 72 dc 34 a0 f1 a4 d0 6c 25 2f f9 3b a4 d5 62
    97 f3 14 4b d5 9a f3 5d 9d c2 49 38 39 d0 ca ca
    53 4d dc a9 c0 57 f1 1a 92 da e0 86 e5 47 12 38
    63 9d a2 83 f3 8a e6 3d b7 fd 2e 51 88 fd db 2a
    fc 5b e9 28 3d cb 83 65 3c ed 5b 86 32 a8 ed 30
    5a 6d 51 5c eb 88 7d ce f2 2f 82 79 42 05 00 d7
    ec 21 86 d0 ee a0 56 8a 60 5d 53 ed d6 ac c4 4b
    29 d1 b5 93 15 b1 8b 9f 27 60 2c 88 3b 36 ce c9
    02 03 01 00 01 30 0d 06 09 2a 86 48 86 f7 0d 01
    01 04 05 00 03 41 00 07 07 80 1a af d6 7e 76 b8
    21 e2 a5 8f 55 6f 2e 8e ac b9 f8 d2 5c 71 9b 61
    5d 71 66 a7 6c 66 e0 d7 7b ef 85 90 f8 f4 55 15
    1b f3 31 ae f4 5d f2 85 6a bd 3e d1 b7 81 68 31
    20 ff ea 15 48 3e 6e
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=jacob/emailAddress=nm@nm.com
verify error:num=20:unable to get local issuer certificate
verify return:1
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=jacob/emailAddress=nm@nm.com
verify error:num=27:certificate not trusted
verify return:1
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=jacob/emailAddress=nm@nm.com
verify error:num=21:unable to verify the first certificate
verify return:1
<<< TLS 1.0 Handshake [length 010d], ServerKeyExchange
    0c 00 01 09 00 80 ae 5b 92 6f 1b b0 60 93 d3 94
    c4 b3 ca 76 95 6d 13 1b 39 70 f6 fb 71 6f f8 de
    5c da 82 e9 35 92 25 6f 0d e2 9e 12 0e 0d 7a ce
    7a e4 5a ec a2 a0 4e e6 08 c1 fb cb e4 5d 64 07
    ce b0 dd 7c fa fb 1d 90 03 05 48 41 a6 f2 2f fc
    a2 75 43 f2 a8 39 bc 6e a5 af 10 de d6 fb 9e 5b
    30 3c 79 97 59 ac 63 32 ec b1 01 ea 37 74 81 1b
    fd 55 75 63 de a5 03 86 f4 d6 1f be 37 7f 19 af
    68 53 1a da 1c c1 00 03 01 00 01 00 80 ac 33 6a
    d0 28 e0 1a 56 0e 69 9e 28 2b b5 6c 93 cb 97 79
    d7 c6 25 06 f7 06 85 58 84 5c 4e 2e 81 a7 48 5a
    40 af a5 ef b5 3c 6f c7 5e 41 e9 77 8c 7b 09 64
    86 5d 36 a6 41 26 71 c8 c3 24 83 97 ce 0d fa 09
    f9 63 23 8e a6 8a ff 07 26 4b ff 92 32 e8 7d ee
    82 fd af c2 1f ca b7 36 7a e1 3e d3 1e 45 17 ca
    e2 4c a5 b1 1b 40 a5 f0 d5 93 1b 3a 9e 5c c7 31
    44 4c fb a6 12 3a 5d 65 2c fe f6 ac 49
>>> TLS 1.0 Alert [length 0002], fatal unexpected_message
    02 0a
8309:error:1408D0F4:SSL routines:SSL3_GET_KEY_EXCHANGE:unexpected message:s3_clnt.c:1187:


............................................................................................................................................


OPENSSL-0.9.8zc(Server,Using Temp Key)LOG:


openssl-0.9.8zc$ ./apps/openssl s_server -cert server.pem -key serverkey.pem -cipher NULL-SHA -msg -tls1
Using default temp DH parameters
Using default temp ECDH parameters
ACCEPT
<<< TLS 1.0 Handshake [length 0035], ClientHello
    01 00 00 31 03 01 55 12 a0 ed 12 25 01 60 53 e9
    ee bd ab 09 f7 21 77 d5 72 52 b2 b1 de 02 91 bc
    7e a4 81 19 16 90 00 00 04 00 02 00 ff 01 00 00
    04 00 23 00 00
>>> TLS 1.0 Handshake [length 0035], ServerHello
    02 00 00 31 03 01 55 12 a0 ed 50 f8 4f 8e d9 ba
    17 3f 29 c5 a6 c5 7b 31 c9 7e 2d 70 fd 78 68 0a
    7b 29 d3 79 50 76 00 00 02 00 00 09 ff 01 00 01
    00 00 23 00 00
>>> TLS 1.0 Handshake [length 0237], Certificate
    0b 00 02 33 00 02 30 00 02 2d 30 82 02 29 30 82
    01 d3 02 09 00 df 98 6f 1f 49 dc ed 59 30 0d 06
    09 2a 86 48 86 f7 0d 01 01 04 05 00 30 7a 31 0b
    30 09 06 03 55 04 06 13 02 49 4e 31 12 30 10 06
    03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b 61 31
    12 30 10 06 03 55 04 07 0c 09 62 61 6e 67 61 6c
    6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02 4e 4d
    31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31 0f 30
    0d 06 03 55 04 03 0c 06 63 68 65 74 61 6e 31 18
    30 16 06 09 2a 86 48 86 f7 0d 01 09 01 16 09 6e
    6d 40 6e 6d 2e 63 6f 6d 30 1e 17 0d 31 35 30 33
    31 36 31 30 31 34 30 32 5a 17 0d 31 37 30 33 31
    35 31 30 31 34 30 32 5a 30 79 31 0b 30 09 06 03
    55 04 06 13 02 49 4e 31 12 30 10 06 03 55 04 08
    0c 09 6b 61 72 6e 61 74 61 6b 61 31 12 30 10 06
    03 55 04 07 0c 09 62 61 6e 67 61 6c 6f 72 65 31
    0b 30 09 06 03 55 04 0a 0c 02 4e 4d 31 0b 30 09
    06 03 55 04 0b 0c 02 4e 4d 31 0e 30 0c 06 03 55
    04 03 0c 05 6a 61 63 6f 62 31 18 30 16 06 09 2a
    86 48 86 f7 0d 01 09 01 16 09 6e 6d 40 6e 6d 2e
    63 6f 6d 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d
    01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00
    b2 72 dc 34 a0 f1 a4 d0 6c 25 2f f9 3b a4 d5 62
    97 f3 14 4b d5 9a f3 5d 9d c2 49 38 39 d0 ca ca
    53 4d dc a9 c0 57 f1 1a 92 da e0 86 e5 47 12 38
    63 9d a2 83 f3 8a e6 3d b7 fd 2e 51 88 fd db 2a
    fc 5b e9 28 3d cb 83 65 3c ed 5b 86 32 a8 ed 30
    5a 6d 51 5c eb 88 7d ce f2 2f 82 79 42 05 00 d7
    ec 21 86 d0 ee a0 56 8a 60 5d 53 ed d6 ac c4 4b
    29 d1 b5 93 15 b1 8b 9f 27 60 2c 88 3b 36 ce c9
    02 03 01 00 01 30 0d 06 09 2a 86 48 86 f7 0d 01
    01 04 05 00 03 41 00 07 07 80 1a af d6 7e 76 b8
    21 e2 a5 8f 55 6f 2e 8e ac b9 f8 d2 5c 71 9b 61
    5d 71 66 a7 6c 66 e0 d7 7b ef 85 90 f8 f4 55 15
    1b f3 31 ae f4 5d f2 85 6a bd 3e d1 b7 81 68 31
    20 ff ea 15 48 3e 6e
Generating temp (1024 bit) RSA key...
>>> TLS 1.0 Handshake [length 010d], ServerKeyExchange
    0c 00 01 09 00 80 ae 5b 92 6f 1b b0 60 93 d3 94
    c4 b3 ca 76 95 6d 13 1b 39 70 f6 fb 71 6f f8 de
    5c da 82 e9 35 92 25 6f 0d e2 9e 12 0e 0d 7a ce
    7a e4 5a ec a2 a0 4e e6 08 c1 fb cb e4 5d 64 07
    ce b0 dd 7c fa fb 1d 90 03 05 48 41 a6 f2 2f fc
    a2 75 43 f2 a8 39 bc 6e a5 af 10 de d6 fb 9e 5b
    30 3c 79 97 59 ac 63 32 ec b1 01 ea 37 74 81 1b
    fd 55 75 63 de a5 03 86 f4 d6 1f be 37 7f 19 af
    68 53 1a da 1c c1 00 03 01 00 01 00 80 ac 33 6a
    d0 28 e0 1a 56 0e 69 9e 28 2b b5 6c 93 cb 97 79
    d7 c6 25 06 f7 06 85 58 84 5c 4e 2e 81 a7 48 5a
    40 af a5 ef b5 3c 6f c7 5e 41 e9 77 8c 7b 09 64
    86 5d 36 a6 41 26 71 c8 c3 24 83 97 ce 0d fa 09
    f9 63 23 8e a6 8a ff 07 26 4b ff 92 32 e8 7d ee
    82 fd af c2 1f ca b7 36 7a e1 3e d3 1e 45 17 ca
    e2 4c a5 b1 1b 40 a5 f0 d5 93 1b 3a 9e 5c c7 31
    44 4c fb a6 12 3a 5d 65 2c fe f6 ac 49
>>> TLS 1.0 Handshake [length 0004], ServerHelloDone
    0e 00 00 00
<<< TLS 1.0 Alert [length 0002], fatal unexpected_message
    02 0a
ERROR
8307:error:140943F2:SSL routines:SSL3_READ_BYTES:sslv3 alert unexpected message:s3_pkt.c:1143:SSL alert number 10
shutting down SSL
CONNECTION CLOSED

