
OPENSSL-0.9.8zd(Client, Safe) LOG:

./apps/openssl s_client -connect 127.0.0.1:4433 -cipher ECDHE-ECDSA-AES256-SHA -ssl3 -msg
CONNECTED(00000003)
>>> SSL 3.0 Handshake [length 002f], ClientHello
    01 00 00 2b 03 00 55 11 56 d6 94 9a b9 e6 d2 d1
    5f 0a 70 37 06 c8 10 44 41 34 30 a3 96 2b 2d ad
    ad 23 60 7d 4c 37 00 00 04 c0 0a 00 ff 01 00
<<< SSL 3.0 Handshake [length 0051], ServerHello
    02 00 00 4d 03 00 8d 3d e9 6c 33 3f 8e 2d 35 78
    f6 87 34 22 ea bc 2c 3a 32 c8 c8 4f ae ba 06 b6
    5d f3 50 e1 0f 4a 20 84 d8 d1 fa 8d 15 2f b6 47
    75 7f 13 c1 6b fc 92 bf c1 97 24 8a 38 f0 42 50
    4e a8 93 4e dd 35 31 c0 0a 00 00 05 ff 01 00 01
    00
<<< SSL 3.0 Handshake [length 0256], Certificate
    0b 00 02 52 00 02 4f 00 02 4c 30 82 02 48 30 82
    01 ee a0 03 02 01 02 02 09 00 c9 60 8a cb cb bb
    c9 b7 30 09 06 07 2a 86 48 ce 3d 04 01 30 81 80
    31 0b 30 09 06 03 55 04 06 13 02 49 4e 31 12 30
    10 06 03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b
    61 31 12 30 10 06 03 55 04 07 0c 09 62 61 6e 67
    61 6c 6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02
    4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31
    0e 30 0c 06 03 55 04 03 0c 05 70 61 74 65 6c 31
    1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09 01 16 10
    63 68 65 74 61 6e 40 70 61 74 65 6c 2e 63 6f 6d
    30 1e 17 0d 31 35 30 33 31 39 30 35 32 37 32 37
    5a 17 0d 31 35 30 34 31 38 30 35 32 37 32 37 5a
    30 81 80 31 0b 30 09 06 03 55 04 06 13 02 49 4e
    31 12 30 10 06 03 55 04 08 0c 09 6b 61 72 6e 61
    74 61 6b 61 31 12 30 10 06 03 55 04 07 0c 09 62
    61 6e 67 61 6c 6f 72 65 31 0b 30 09 06 03 55 04
    0a 0c 02 4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02
    4e 4d 31 0e 30 0c 06 03 55 04 03 0c 05 70 61 74
    65 6c 31 1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09
    01 16 10 63 68 65 74 61 6e 40 70 61 74 65 6c 2e
    63 6f 6d 30 59 30 13 06 07 2a 86 48 ce 3d 02 01
    06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 b7 57
    81 2c dc 63 b5 92 7a f8 41 78 64 2e 90 94 8d 49
    b1 85 e4 5d 18 87 d5 1d fe b8 ef 25 c1 74 01 89
    f9 e4 df c8 2d 48 f7 7f 62 30 70 b5 65 bb ff 5a
    8f 64 1b 84 95 55 7f 66 69 32 2f 64 44 e5 a3 50
    30 4e 30 1d 06 03 55 1d 0e 04 16 04 14 f0 e8 8f
    47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a f8
    6b 30 1f 06 03 55 1d 23 04 18 30 16 80 14 f0 e8
    8f 47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a
    f8 6b 30 0c 06 03 55 1d 13 04 05 30 03 01 01 ff
    30 09 06 07 2a 86 48 ce 3d 04 01 03 49 00 30 46
    02 21 00 f2 8d 12 6e e7 79 6e 08 95 f5 e1 b7 f4
    81 35 c4 6a ae e4 f3 31 9b cd 9a 1a 76 14 46 6d
    31 cc 86 02 21 00 8c fc 19 41 cc b0 c7 ef 17 3e
    c5 4f ab 0e 2b 56 38 f7 78 65 d5 81 7c f8 df 13
    6d 38 16 70 7f 21
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
verify error:num=18:self signed certificate
verify return:1
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
verify return:1
<<< SSL 3.0 Handshake [length 0004], ServerHelloDone
    0e 00 00 00
>>> SSL 3.0 Alert [length 0002], fatal unexpected_message
    02 0a
23565:error:1408D0F4:SSL routines:SSL3_GET_KEY_EXCHANGE:unexpected message:s3_clnt.c:1137:


.............................................................................................................................................


OPENSSL-1.0.1k(Server,Skipping Seever Key Exchange) LOG:

openssl-1.0.1k$ ./apps/openssl s_server -accept 4433 -cert ecdhcert.pem -key ecdhkey.pem -ssl3 -msg
Using default temp DH parameters
Using default temp ECDH parameters
ACCEPT
<<< SSL 3.0 Handshake [length 002f], ClientHello
    01 00 00 2b 03 00 55 11 56 d6 94 9a b9 e6 d2 d1
    5f 0a 70 37 06 c8 10 44 41 34 30 a3 96 2b 2d ad
    ad 23 60 7d 4c 37 00 00 04 c0 0a 00 ff 01 00
>>> SSL 3.0 Handshake [length 0051], ServerHello
    02 00 00 4d 03 00 8d 3d e9 6c 33 3f 8e 2d 35 78
    f6 87 34 22 ea bc 2c 3a 32 c8 c8 4f ae ba 06 b6
    5d f3 50 e1 0f 4a 20 84 d8 d1 fa 8d 15 2f b6 47
    75 7f 13 c1 6b fc 92 bf c1 97 24 8a 38 f0 42 50
    4e a8 93 4e dd 35 31 c0 0a 00 00 05 ff 01 00 01
    00
>>> SSL 3.0 Handshake [length 0256], Certificate
    0b 00 02 52 00 02 4f 00 02 4c 30 82 02 48 30 82
    01 ee a0 03 02 01 02 02 09 00 c9 60 8a cb cb bb
    c9 b7 30 09 06 07 2a 86 48 ce 3d 04 01 30 81 80
    31 0b 30 09 06 03 55 04 06 13 02 49 4e 31 12 30
    10 06 03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b
    61 31 12 30 10 06 03 55 04 07 0c 09 62 61 6e 67
    61 6c 6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02
    4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31
    0e 30 0c 06 03 55 04 03 0c 05 70 61 74 65 6c 31
    1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09 01 16 10
    63 68 65 74 61 6e 40 70 61 74 65 6c 2e 63 6f 6d
    30 1e 17 0d 31 35 30 33 31 39 30 35 32 37 32 37
    5a 17 0d 31 35 30 34 31 38 30 35 32 37 32 37 5a
    30 81 80 31 0b 30 09 06 03 55 04 06 13 02 49 4e
    31 12 30 10 06 03 55 04 08 0c 09 6b 61 72 6e 61
    74 61 6b 61 31 12 30 10 06 03 55 04 07 0c 09 62
    61 6e 67 61 6c 6f 72 65 31 0b 30 09 06 03 55 04
    0a 0c 02 4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02
    4e 4d 31 0e 30 0c 06 03 55 04 03 0c 05 70 61 74
    65 6c 31 1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09
    01 16 10 63 68 65 74 61 6e 40 70 61 74 65 6c 2e
    63 6f 6d 30 59 30 13 06 07 2a 86 48 ce 3d 02 01
    06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 b7 57
    81 2c dc 63 b5 92 7a f8 41 78 64 2e 90 94 8d 49
    b1 85 e4 5d 18 87 d5 1d fe b8 ef 25 c1 74 01 89
    f9 e4 df c8 2d 48 f7 7f 62 30 70 b5 65 bb ff 5a
    8f 64 1b 84 95 55 7f 66 69 32 2f 64 44 e5 a3 50
    30 4e 30 1d 06 03 55 1d 0e 04 16 04 14 f0 e8 8f
    47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a f8
    6b 30 1f 06 03 55 1d 23 04 18 30 16 80 14 f0 e8
    8f 47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a
    f8 6b 30 0c 06 03 55 1d 13 04 05 30 03 01 01 ff
    30 09 06 07 2a 86 48 ce 3d 04 01 03 49 00 30 46
    02 21 00 f2 8d 12 6e e7 79 6e 08 95 f5 e1 b7 f4
    81 35 c4 6a ae e4 f3 31 9b cd 9a 1a 76 14 46 6d
    31 cc 86 02 21 00 8c fc 19 41 cc b0 c7 ef 17 3e
    c5 4f ab 0e 2b 56 38 f7 78 65 d5 81 7c f8 df 13
    6d 38 16 70 7f 21
>>> SSL 3.0 Handshake [length 0004], ServerHelloDone
    0e 00 00 00
<<< SSL 3.0 Alert [length 0002], fatal unexpected_message
    02 0a
ERROR
3078125720:error:140943F2:SSL routines:SSL3_READ_BYTES:sslv3 alert unexpected message:s3_pkt.c:1293:SSL alert number 10
shutting down SSL
CONNECTION CLOSED

