
->->  OPENSSL-0.9.8zc(Client, Vulnerable) LOG:

openssl-0.9.8zc$ ./apps/openssl s_client -connect 127.0.0.1:4433 -cipher ECDHE-ECDSA-AES256-SHA -ssl3 -msg
CONNECTED(00000003)
>>> SSL 3.0 Handshake [length 002f], ClientHello
    01 00 00 2b 03 00 55 11 54 33 7f 3a d9 02 6d d9
    01 39 8f dc fa 74 da 1a c7 c6 df 5a 1f 8a 73 85
    fa b8 59 c8 eb b3 00 00 04 c0 0a 00 ff 01 00
<<< SSL 3.0 Handshake [length 0051], ServerHello
    02 00 00 4d 03 00 07 bd 21 24 d2 9a a4 3e c4 b0
    e1 a0 83 42 09 5f 94 8f e3 42 eb 1e 81 47 85 7d
    3d 41 b0 90 10 f1 20 a7 64 39 12 37 67 8d c0 61
    68 b6 bf c4 20 2b 8a b1 45 24 81 d3 12 5d 2e 19
    4c e6 e7 34 29 ec de c0 0a 00 00 05 ff 01 00 01
    00
<<< SSL 3.0 Handshake [length 0256], Certificate
    0b 00 02 52 00 02 4f 00 02 4c 30 82 02 48 30 82
    01 ee a0 03 02 01 02 02 09 00 c9 60 8a cb cb bb
    c9 b7 30 09 06 07 2a 86 48 ce 3d 04 01 30 81 80
    31 0b 30 09 06 03 55 04 06 13 02 49 4e 31 12 30
    10 06 03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b
    61 31 12 30 10 06 03 55 04 07 0c 09 62 61 6e 67
    61 6c 6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02
    4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31
    0e 30 0c 06 03 55 04 03 0c 05 70 61 74 65 6c 31
    1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09 01 16 10
    63 68 65 74 61 6e 40 70 61 74 65 6c 2e 63 6f 6d
    30 1e 17 0d 31 35 30 33 31 39 30 35 32 37 32 37
    5a 17 0d 31 35 30 34 31 38 30 35 32 37 32 37 5a
    30 81 80 31 0b 30 09 06 03 55 04 06 13 02 49 4e
    31 12 30 10 06 03 55 04 08 0c 09 6b 61 72 6e 61
    74 61 6b 61 31 12 30 10 06 03 55 04 07 0c 09 62
    61 6e 67 61 6c 6f 72 65 31 0b 30 09 06 03 55 04
    0a 0c 02 4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02
    4e 4d 31 0e 30 0c 06 03 55 04 03 0c 05 70 61 74
    65 6c 31 1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09
    01 16 10 63 68 65 74 61 6e 40 70 61 74 65 6c 2e
    63 6f 6d 30 59 30 13 06 07 2a 86 48 ce 3d 02 01
    06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 b7 57
    81 2c dc 63 b5 92 7a f8 41 78 64 2e 90 94 8d 49
    b1 85 e4 5d 18 87 d5 1d fe b8 ef 25 c1 74 01 89
    f9 e4 df c8 2d 48 f7 7f 62 30 70 b5 65 bb ff 5a
    8f 64 1b 84 95 55 7f 66 69 32 2f 64 44 e5 a3 50
    30 4e 30 1d 06 03 55 1d 0e 04 16 04 14 f0 e8 8f
    47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a f8
    6b 30 1f 06 03 55 1d 23 04 18 30 16 80 14 f0 e8
    8f 47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a
    f8 6b 30 0c 06 03 55 1d 13 04 05 30 03 01 01 ff
    30 09 06 07 2a 86 48 ce 3d 04 01 03 49 00 30 46
    02 21 00 f2 8d 12 6e e7 79 6e 08 95 f5 e1 b7 f4
    81 35 c4 6a ae e4 f3 31 9b cd 9a 1a 76 14 46 6d
    31 cc 86 02 21 00 8c fc 19 41 cc b0 c7 ef 17 3e
    c5 4f ab 0e 2b 56 38 f7 78 65 d5 81 7c f8 df 13
    6d 38 16 70 7f 21
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
verify error:num=18:self signed certificate
verify return:1
depth=0 /C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
verify return:1
<<< SSL 3.0 Handshake [length 0004], ServerHelloDone
    0e 00 00 00
>>> SSL 3.0 Handshake [length 0046], ClientKeyExchange
    10 00 00 42 41 04 7b fe ee e3 d4 58 89 2c ad e5
    ad 12 1c db 3b ea 7b 0e 79 08 ba d1 dd ee c5 26
    88 de 34 09 85 ca d7 50 86 a2 d3 61 a4 46 50 b1
    79 a1 3b b8 a5 02 49 47 0c ce 44 89 58 dd eb 69
    23 6a e1 08 46 f8
>>> SSL 3.0 ChangeCipherSpec [length 0001]
    01
>>> SSL 3.0 Handshake [length 0028], Finished
    14 00 00 24 e0 6a 4d 1d 31 c8 9b 20 f7 c2 cb 6c
    a4 3b d8 33 8a d6 29 39 7d 77 45 c9 09 c6 ec 0b
    cf 82 51 05 9f 07 43 82
<<< SSL 3.0 ChangeCipherSpec [length 0001]
    01
<<< SSL 3.0 Handshake [length 0028], Finished
    14 00 00 24 a8 cc 53 46 01 20 90 01 51 ab 12 c4
    e3 94 57 d0 34 ff 5b 65 f3 3f 1d a5 02 29 00 9c
    c8 b6 fc d4 c1 e9 ef 3f
---
Certificate chain
 0 s:/C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
   i:/C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
---
Server certificate
-----BEGIN CERTIFICATE-----
MIICSDCCAe6gAwIBAgIJAMlgisvLu8m3MAkGByqGSM49BAEwgYAxCzAJBgNVBAYT
AklOMRIwEAYDVQQIDAlrYXJuYXRha2ExEjAQBgNVBAcMCWJhbmdhbG9yZTELMAkG
A1UECgwCTk0xCzAJBgNVBAsMAk5NMQ4wDAYDVQQDDAVwYXRlbDEfMB0GCSqGSIb3
DQEJARYQY2hldGFuQHBhdGVsLmNvbTAeFw0xNTAzMTkwNTI3MjdaFw0xNTA0MTgw
NTI3MjdaMIGAMQswCQYDVQQGEwJJTjESMBAGA1UECAwJa2FybmF0YWthMRIwEAYD
VQQHDAliYW5nYWxvcmUxCzAJBgNVBAoMAk5NMQswCQYDVQQLDAJOTTEOMAwGA1UE
AwwFcGF0ZWwxHzAdBgkqhkiG9w0BCQEWEGNoZXRhbkBwYXRlbC5jb20wWTATBgcq
hkjOPQIBBggqhkjOPQMBBwNCAAS3V4Es3GO1knr4QXhkLpCUjUmxheRdGIfVHf64
7yXBdAGJ+eTfyC1I939iMHC1Zbv/Wo9kG4SVVX9maTIvZETlo1AwTjAdBgNVHQ4E
FgQU8OiPR/UBqkubVoWquvrCdQo6+GswHwYDVR0jBBgwFoAU8OiPR/UBqkubVoWq
uvrCdQo6+GswDAYDVR0TBAUwAwEB/zAJBgcqhkjOPQQBA0kAMEYCIQDyjRJu53lu
CJX14bf0gTXEaq7k8zGbzZoadhRGbTHMhgIhAIz8GUHMsMfvFz7FT6sOK1Y493hl
1YF8+N8TbTgWcH8h
-----END CERTIFICATE-----
subject=/C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
issuer=/C=IN/ST=karnataka/L=bangalore/O=NM/OU=NM/CN=patel/emailAddress=chetan@patel.com
---
No client certificate CA names sent
---
SSL handshake has read 773 bytes and written 202 bytes
---
New, TLSv1/SSLv3, Cipher is ECDHE-ECDSA-AES256-SHA
Server public key is 256 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : SSLv3
    Cipher    : ECDHE-ECDSA-AES256-SHA
    Session-ID: A764391237678DC06168B6BFC4202B8AB1452481D3125D2E194CE6E73429ECDE
    Session-ID-ctx: 
    Master-Key: 0A94A7CC17192D6F3A4B7D755F12FBFB810D1F4879CFB476C71E6971FE6CA4A39D0016B5D0345FD78AB79C7ADFB53328
    Key-Arg   : None
    Start Time: 1427199027
    Timeout   : 7200 (sec)
    Verify return code: 18 (self signed certificate)
---
Test msg1
Reply to testmsg1.OK

......................................................................................................................................


OPENSSL-1.0.1k(Server,Skipping ServerKeyExchange)LOG:


openssl-1.0.1k$ ./apps/openssl s_server -accept 4433 -cert ecdhcert.pem -key ecdhkey.pem -ssl3 -msg
Using default temp DH parameters
Using default temp ECDH parameters
ACCEPT
<<< SSL 3.0 Handshake [length 002f], ClientHello
    01 00 00 2b 03 00 55 11 54 33 7f 3a d9 02 6d d9
    01 39 8f dc fa 74 da 1a c7 c6 df 5a 1f 8a 73 85
    fa b8 59 c8 eb b3 00 00 04 c0 0a 00 ff 01 00
>>> SSL 3.0 Handshake [length 0051], ServerHello
    02 00 00 4d 03 00 07 bd 21 24 d2 9a a4 3e c4 b0
    e1 a0 83 42 09 5f 94 8f e3 42 eb 1e 81 47 85 7d
    3d 41 b0 90 10 f1 20 a7 64 39 12 37 67 8d c0 61
    68 b6 bf c4 20 2b 8a b1 45 24 81 d3 12 5d 2e 19
    4c e6 e7 34 29 ec de c0 0a 00 00 05 ff 01 00 01
    00
>>> SSL 3.0 Handshake [length 0256], Certificate
    0b 00 02 52 00 02 4f 00 02 4c 30 82 02 48 30 82
    01 ee a0 03 02 01 02 02 09 00 c9 60 8a cb cb bb
    c9 b7 30 09 06 07 2a 86 48 ce 3d 04 01 30 81 80
    31 0b 30 09 06 03 55 04 06 13 02 49 4e 31 12 30
    10 06 03 55 04 08 0c 09 6b 61 72 6e 61 74 61 6b
    61 31 12 30 10 06 03 55 04 07 0c 09 62 61 6e 67
    61 6c 6f 72 65 31 0b 30 09 06 03 55 04 0a 0c 02
    4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02 4e 4d 31
    0e 30 0c 06 03 55 04 03 0c 05 70 61 74 65 6c 31
    1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09 01 16 10
    63 68 65 74 61 6e 40 70 61 74 65 6c 2e 63 6f 6d
    30 1e 17 0d 31 35 30 33 31 39 30 35 32 37 32 37
    5a 17 0d 31 35 30 34 31 38 30 35 32 37 32 37 5a
    30 81 80 31 0b 30 09 06 03 55 04 06 13 02 49 4e
    31 12 30 10 06 03 55 04 08 0c 09 6b 61 72 6e 61
    74 61 6b 61 31 12 30 10 06 03 55 04 07 0c 09 62
    61 6e 67 61 6c 6f 72 65 31 0b 30 09 06 03 55 04
    0a 0c 02 4e 4d 31 0b 30 09 06 03 55 04 0b 0c 02
    4e 4d 31 0e 30 0c 06 03 55 04 03 0c 05 70 61 74
    65 6c 31 1f 30 1d 06 09 2a 86 48 86 f7 0d 01 09
    01 16 10 63 68 65 74 61 6e 40 70 61 74 65 6c 2e
    63 6f 6d 30 59 30 13 06 07 2a 86 48 ce 3d 02 01
    06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 b7 57
    81 2c dc 63 b5 92 7a f8 41 78 64 2e 90 94 8d 49
    b1 85 e4 5d 18 87 d5 1d fe b8 ef 25 c1 74 01 89
    f9 e4 df c8 2d 48 f7 7f 62 30 70 b5 65 bb ff 5a
    8f 64 1b 84 95 55 7f 66 69 32 2f 64 44 e5 a3 50
    30 4e 30 1d 06 03 55 1d 0e 04 16 04 14 f0 e8 8f
    47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a f8
    6b 30 1f 06 03 55 1d 23 04 18 30 16 80 14 f0 e8
    8f 47 f5 01 aa 4b 9b 56 85 aa ba fa c2 75 0a 3a
    f8 6b 30 0c 06 03 55 1d 13 04 05 30 03 01 01 ff
    30 09 06 07 2a 86 48 ce 3d 04 01 03 49 00 30 46
    02 21 00 f2 8d 12 6e e7 79 6e 08 95 f5 e1 b7 f4
    81 35 c4 6a ae e4 f3 31 9b cd 9a 1a 76 14 46 6d
    31 cc 86 02 21 00 8c fc 19 41 cc b0 c7 ef 17 3e
    c5 4f ab 0e 2b 56 38 f7 78 65 d5 81 7c f8 df 13
    6d 38 16 70 7f 21
>>> SSL 3.0 Handshake [length 0004], ServerHelloDone
    0e 00 00 00
<<< SSL 3.0 Handshake [length 0046], ClientKeyExchange
    10 00 00 42 41 04 7b fe ee e3 d4 58 89 2c ad e5
    ad 12 1c db 3b ea 7b 0e 79 08 ba d1 dd ee c5 26
    88 de 34 09 85 ca d7 50 86 a2 d3 61 a4 46 50 b1
    79 a1 3b b8 a5 02 49 47 0c ce 44 89 58 dd eb 69
    23 6a e1 08 46 f8
<<< SSL 3.0 ChangeCipherSpec [length 0001]
    01
<<< SSL 3.0 Handshake [length 0028], Finished
    14 00 00 24 e0 6a 4d 1d 31 c8 9b 20 f7 c2 cb 6c
    a4 3b d8 33 8a d6 29 39 7d 77 45 c9 09 c6 ec 0b
    cf 82 51 05 9f 07 43 82
>>> SSL 3.0 ChangeCipherSpec [length 0001]
    01
>>> SSL 3.0 Handshake [length 0028], Finished
    14 00 00 24 a8 cc 53 46 01 20 90 01 51 ab 12 c4
    e3 94 57 d0 34 ff 5b 65 f3 3f 1d a5 02 29 00 9c
    c8 b6 fc d4 c1 e9 ef 3f
-----BEGIN SSL SESSION PARAMETERS-----
MHUCAQECAgMABALACgQgp2Q5EjdnjcBhaLa/xCArirFFJIHTEl0uGUzm5zQp7N4E
MAqUp8wXGS1vOkt9dV8S+/uBDR9Iec+0dsceaXH+bKSjnQAWtdA0X9eKt5x637Uz
KKEGAgRVEVQzogQCAhwgpAYEBAEAAAA=
-----END SSL SESSION PARAMETERS-----
Shared ciphers:ECDHE-ECDSA-AES256-SHA
CIPHER is ECDHE-ECDSA-AES256-SHA
Secure Renegotiation IS supported
Test msg1
Reply to testmsg1.OK


